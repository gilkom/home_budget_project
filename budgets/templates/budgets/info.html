{% extends "budgets/base.html" %}

    {% block page_header %}

        {% if is_period == False %}

                <div class="jumbotron">
                    <h1 class="display-4">Current period details</h1>

                    <p class="lead">First you have to <a href="{% url 'budgets:periods' %}">create period</a>,
                        its goals and balance...</p>

                    <a class="btn btn-lg btn-primary" href="{% url 'budgets:periods' %}"
                       role="button">Create period &raquo;</a>
                </div>

        {% else %}

                <div>
                    <h2>Details of the current period:</h2>
                </div>
        {% endif %}

    {% endblock page_header %}

    {% block content %}

        {% if is_period == True %}

            <div class="progress">
              <div class="progress-bar progress-bar-striped bg-{{page_color}}" role="progressbar" aria-valuenow={{progress}}
                aria-valuemin="0" aria-valuemax={{period_length}} style="width:{{progress}}%">
                  {{ days_passed }} / {{ period_length }} days
                <span class="sr-only"></span>
              </div>
            </div>

            <br>
            <div class="p-3 mb-2 alert-{{page_color}} text-dark rounded">
                <div class="float-right">{{ period.start_day|date:"d.m.Y" }} - {{ period.end_day|date:"d.m.Y" }}</div><br>
                <div class="row justify-content-center ">
                    <h1>{{ period.name }}</h1>
                </div>
                <br>

                <div class="container">
                  <div class="row justify-content-center ">
                    <div class="col-5 border-0 text-dark rounded bg-white">
                        <h6 class="font-weight-bold">Daily avg. expenses:</h6>
                      <h1 class="font-weight-bold">{{ average_over_the_period }}</h1>
                    </div>
                      <div class="col-auto"></div>
                    <div class="col-5 border-0 text-dark rounded bg-white">
                        <h6 class="font-weight-bold">Estimated savings:</h6>
                      <h1 class="font-weight-bold">{{ estimated_savings }}</h1>
                    </div>
                  </div>
                </div>
                <br>
                <div class="container">
                  <div class="row justify-content-center">
                    <div class="col-4">
                      <p>Initial budget: {{ balance.amount }}</p>
                    </div>
                    <div class="col-4">
                      <p>Remaining funds: {{ money_saved }} </p>
                    </div>
                     <div class="col-4">
                      <p>Sum of expenses: {{ sum_of_expenses }}</p>
                    </div>
                  </div>
                </div>
                <br>

            </div>
            
            {% if is_goal == False %}
                <p>Create <a href="{% url 'budgets:periods' %}">goals</a> for this period to see more details...</p>
            {% else %}
                <div class="p-3 mb-2 bg-light text-dark rounded">
                    <h4>Details of goals:</h4>
                    <p>Daily avg. goal: {{ daily_average_goal }}</p>
                    <p>Sum of goals: {{ sum_of_goals }}
                    <p>Planned savings: {{ planned_savings }} </p>
                </div>
                <div class="p-3 mb-2 rounded">
                    <table class="table table-sm">
                        <tr>
                            <th>Category:</th>
                            <th>Goal:</th>
                            <th>Daily goal:</th>
                            <th>Daily spendings:</th>
                        </tr>
                        {% for key, value in goals_dict.items %}
                        <tr>
                            <td> {{ value.name }} </td>
                            <td> {{ value.goal }} </td>
                            <td> {{ value.av_period }} </td>
                            <td> {{ value.av_daily }} </td>
                        </tr>
                    {% endfor %}
                    </table>
                </div>
            {% endif %}
        {% endif %}
    {% endblock content %}